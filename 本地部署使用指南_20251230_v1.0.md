# 本地部署使用指南

**文档版本**: v1.0  
**创建日期**: 2025-12-30  
**适用范围**: 飞书文档转换 Markdown 工具

---

## 🚀 快速开始

### 方式 1：使用启动脚本（推荐）

```bash
cd /Users/dong/Documents/Tare/Feishu2md/feishu2md
./start.sh
```

选择启动方式：
- 选项 1：本地运行（仅自己使用）
- 选项 2：本地运行 + ngrok（可分享给他人）

### 方式 2：手动启动

#### 本地运行

```bash
cd /Users/dong/Documents/Tare/Feishu2md/feishu2md

# 编译应用（如果还没编译）
go build -o feishu2md4web ./web/*.go

# 启动应用
./feishu2md4web
```

访问：http://localhost:8080

#### 本地运行 + ngrok

```bash
cd /Users/dong/Documents/Tare/Feishu2md/feishu2md

# 终端 1：启动应用
./feishu2md4web

# 终端 2：启动 ngrok
ngrok http 8080
```

ngrok 会显示一个公网地址，比如：`https://xxxx-xx-xx-xx-xx.ngrok-free.app`

---

## 📦 安装 ngrok

### macOS

```bash
brew install ngrok
```

### 其他系统

访问 https://ngrok.com/download 下载对应系统的安装包

---

## 🎯 使用场景

### 场景 1：个人使用

使用本地运行即可，无需 ngrok。

### 场景 2：分享给他人

使用本地运行 + ngrok，将 ngrok 提供的公网地址分享给他人。

### 场景 3：临时演示

使用本地运行 + ngrok，适合临时演示或测试。

---

## ⚠️ 注意事项

### ngrok 免费版限制

- 每次重启 ngrok，地址会变化
- 免费版有流量限制（但足够个人使用）
- 连接数有限制（但足够个人使用）

### 应用运行要求

- 需要 Go 1.21 或更高版本
- 需要网络连接（访问飞书 API）

---

## 🔧 故障排除

### 问题 1：应用无法启动

**解决方案：**
```bash
# 重新编译应用
go build -o feishu2md4web ./web/*.go

# 检查端口是否被占用
lsof -i :8080

# 如果端口被占用，杀死占用进程
kill -9 <PID>
```

### 问题 2：ngrok 无法启动

**解决方案：**
```bash
# 检查 ngrok 是否安装
which ngrok

# 如果未安装，重新安装
brew install ngrok

# 检查 ngrok 配置
ngrok config check
```

### 问题 3：无法访问飞书 API

**解决方案：**
- 检查环境变量是否正确设置
- 检查网络连接
- 检查飞书应用凭证是否有效

---

## 📊 性能优化

### 1. 使用编译缓存

```bash
go build -a -o feishu2md4web ./web/*.go
```

### 2. 启用 Go 模块缓存

```bash
export GOCACHE=$HOME/.cache/go-build
```

---

## 🔒 安全建议

1. **不要在公网环境中暴露敏感信息**
   - ngrok 地址是临时的，不要长期使用
   - 不要将 ngrok 地址发布到公开场合

2. **定期更新依赖**
   ```bash
   go get -u ./...
   go mod tidy
   ```

3. **使用防火墙**
   - 如果不需要对外访问，关闭防火墙端口
   - 使用 ngrok 时，注意访问控制

---

## 📚 相关资源

- **ngrok 官方文档**: https://ngrok.com/docs
- **Go 语言官方文档**: https://golang.org/doc/
- **Gin 框架文档**: https://gin-gonic.com/docs/

---

**最后更新**: 2025-12-30  
**维护者**: AI 开发助手  
**版本**: v1.0
